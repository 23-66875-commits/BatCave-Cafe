<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book a Study Room | The Malvar Bat Cave Cafe</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style type="text/css">
      body {
        background-color: #0f172a; /* slate-900 */
        color: #e2e8f0; /* slate-300 */
      }
      h1 {
        font-size: 3rem; /* 48px */
        line-height: 1;
        font-weight: 700;
      }
      h2 {
        font-size: 2.25rem; /* 36px */
        line-height: 2.5rem;
        font-weight: 700;
      }
      h3 {
        font-size: 1.5rem; /* 24px */
        line-height: 2rem;
        font-weight: 700;
      }
      /* Custom styling to match the <Input> and <Checkbox> components' look */
      input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="time"], input[type="number"] {
          height: 2.5rem;
          padding: 0.5rem 0.75rem;
          border-radius: 0.375rem;
          border: 1px solid var(--tw-border-color);
          --tw-border-opacity: 1;
      }
      input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(0.8) }
      .checkbox-container {
        display: inline-flex;
        align-items: center;
        width: 1rem;
        height: 1rem;
        border-radius: 0.25rem;
        border: 1px solid #475569; /* slate-600 */
        cursor: pointer;
        transition: all 150ms;
      }
      .checkbox-container.checked {
        background-color: #a78bfa; /* violet-400 */
        border-color: #a78bfa;
      }
      .checkbox-indicator {
        display: none;
        color: #0f172a; /* slate-900 */
      }
      .checkbox-container.checked .checkbox-indicator {
        display: block;
      }
    </style>
  </head>
  <body class="bg-slate-900 text-slate-300">
    
    <div class="min-h-screen py-12 px-4">
      <div class="container mx-auto max-w-4xl">
        
        <div class="text-center mb-12">
          <h1 class="text-slate-100 mb-4">Book a Study Room</h1>
          <p class="text-lg text-slate-300">
            Reserve your private study space with optional equipment rental
          </p>
        </div>

        <form id="booking-form" class="space-y-8">
          
          <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-6">
            <h2 class="text-slate-100 mb-6 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-violet-500"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
              Personal Information
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              
              <div>
                <label for="studentId" class="text-slate-300 block mb-1">Student ID *</label>
                <input
                  id="studentId"
                  name="studentId"
                  type="text"
                  placeholder="2021-12345"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-studentId"></p>
              </div>

              <div>
                <label for="fullName" class="text-slate-300 block mb-1">Full Name *</label>
                <input
                  id="fullName"
                  name="fullName"
                  type="text"
                  placeholder="Juan Dela Cruz"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-fullName"></p>
              </div>

              <div>
                <label for="email" class="text-slate-300 block mb-1">Email Address *</label>
                <input
                  id="email"
                  name="email"
                  type="email"
                  placeholder="student@batstate-u.edu.ph"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-email"></p>
              </div>

              <div>
                <label for="phone" class="text-slate-300 block mb-1">Phone Number *</label>
                <input
                  id="phone"
                  name="phone"
                  type="tel"
                  placeholder="09123456789"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-phone"></p>
              </div>
            </div>
          </div>

          <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-6">
            <h2 class="text-slate-100 mb-6 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-violet-500"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
              Booking Details
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              
              <div>
                <label for="date" class="text-slate-300 block mb-1">Reservation Date *</label>
                <input
                  id="date"
                  name="date"
                  type="date"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-date"></p>
              </div>

              <div>
                <label for="startTime" class="text-slate-300 block mb-1">Start Time *</label>
                <div class="relative">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 mt-[2px]"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                  <input
                    id="startTime"
                    name="startTime"
                    type="time"
                    class="bg-slate-900 border-slate-600 text-slate-100 w-full pl-10"
                  />
                </div>
                <p class="error-message text-red-400 text-sm mt-1" id="error-startTime"></p>
              </div>

              <div>
                <label for="hours" class="text-slate-300 block mb-1">Number of Hours *</label>
                <input
                  id="hours"
                  name="hours"
                  type="number"
                  min="1"
                  placeholder="e.g., 3"
                  class="bg-slate-900 border-slate-600 text-slate-100 w-full"
                />
                <p class="error-message text-red-400 text-sm mt-1" id="error-hours"></p>
              </div>
            </div>
          </div>

          <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-6">
            <h2 class="text-slate-100 mb-6 flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-violet-500"><path d="M12 2a3 3 0 0 0-3 3v.3c-2 .5-4 2-4 5.7V22l4-1 4 1 4-1V11c0-3.7-2-5.2-4-5.7V5a3 3 0 0 0-3-3Z"/></svg>
              Equipment Rental (Optional)
            </h2>
            
            <div class="space-y-4">
              
              <div class="flex items-center space-x-3 p-4 bg-slate-900/50 rounded-lg border border-slate-600">
                <div id="checkbox-projector" class="checkbox-container">
                    <svg class="checkbox-indicator w-full h-full p-[1px]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                </div>
                <input type="hidden" id="projector" name="projector" value="false">
                <div class="flex-1">
                  <label for="checkbox-projector" class="text-slate-200 cursor-pointer">Projector</label>
                  <p class="text-sm text-slate-400">₱150.00 per hour</p>
                </div>
              </div>

              <div class="flex items-center space-x-3 p-4 bg-slate-900/50 rounded-lg border border-slate-600">
                <div id="checkbox-speakerMic" class="checkbox-container">
                    <svg class="checkbox-indicator w-full h-full p-[1px]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></polyline>
                </div>
                <input type="hidden" id="speakerMic" name="speakerMic" value="false">
                <div class="flex-1">
                  <label for="checkbox-speakerMic" class="text-slate-200 cursor-pointer">Speaker & Microphone</label>
                  <p class="text-sm text-slate-400">₱150.00 per hour</p>
                </div>
              </div>
            </div>
          </div>

          <div id="cost-breakdown" class="hidden bg-gradient-to-r from-amber-900/20 to-orange-900/20 border border-amber-600 rounded-lg p-6">
            <div class="flex items-center gap-3 mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-amber-600"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="16" y2="14"/><line x1="8" y1="18" x2="16" y2="18"/></svg>
              <h3 class="text-slate-100">Estimated Cost Breakdown</h3>
            </div>
            
            <div class="space-y-3" id="cost-details">
              </div>

            <p class="text-sm text-slate-400 mt-4 bg-slate-800/50 p-3 rounded hidden" id="minimum-fee-note">
              Note: Minimum fee of ₱75.00 applies for bookings under 2 hours
            </p>
          </div>

          <div class="flex flex-col sm:flex-row gap-4">
            <button
              type="button"
              id="calculate-button"
              class="flex-1 bg-indigo-900 hover:bg-indigo-800 text-white py-3 rounded-lg border border-indigo-700 transition-colors flex items-center justify-center gap-2"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="16" y2="14"/><line x1="8" y1="18" x2="16" y2="18"/></svg>
              Calculate Cost
            </button>
            
            <button
              type="submit"
              id="submit-button"
              disabled
              class="flex-1 py-3 rounded-lg transition-colors flex items-center justify-center gap-2 bg-slate-700 text-slate-500 cursor-not-allowed"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              Submit Reservation
            </button>
            
            <button
              type="button"
              id="reset-button"
              class="sm:w-auto bg-slate-700 hover:bg-slate-600 text-slate-300 py-3 px-6 rounded-lg transition-colors"
            >
              Reset Form
            </button>
          </div>

          <div
            id="confirmation"
            class="hidden mt-8 bg-gradient-to-r from-green-900/20 to-emerald-900/20 border border-green-600 rounded-lg p-8 text-center"
          >
            </div>
        </form>

        <div class="mt-8 bg-slate-800/30 border border-slate-700 rounded-lg p-6">
          <h3 class="text-slate-100 mb-3">Booking Information</h3>
          <ul class="space-y-2 text-slate-400 text-sm">
            <li>• Base room rate: ₱50.00 per hour</li>
            <li>• Minimum booking fee: ₱75.00 (applies to bookings under 2 hours)</li>
            <li>• Equipment rental fees are charged per hour of booking</li>
            <li>• Reservations are subject to availability and confirmation</li>
            <li>• Cancellations must be made at least 24 hours in advance</li>
            <li>• Payment instructions will be sent upon confirmation</li>
          </ul>
        </div>
      </div>
    </div>
    
    <script>
      const form = document.getElementById('booking-form');
      const submitButton = document.getElementById('submit-button');
      const calculateButton = document.getElementById('calculate-button');
      const resetButton = document.getElementById('reset-button');
      const costBreakdown = document.getElementById('cost-breakdown');
      const costDetails = document.getElementById('cost-details');
      const confirmationDiv = document.getElementById('confirmation');
      const minFeeNote = document.getElementById('minimum-fee-note');
      
      let estimatedCost = null;

      // --- Helper Functions ---

      function formatCurrency(amount) {
          return `₱${amount.toFixed(2)}`;
      }

      function getFormData() {
          const data = {
              studentId: form.studentId.value,
              fullName: form.fullName.value,
              email: form.email.value,
              phone: form.phone.value,
              date: form.date.value,
              startTime: form.startTime.value,
              hours: parseInt(form.hours.value) || 0,
              projector: form.projector.value === 'true',
              speakerMic: form.speakerMic.value === 'true',
          };
          return data;
      }

      function toggleError(fieldId, message = '') {
          const input = document.getElementById(fieldId);
          const errorMsg = document.getElementById(`error-${fieldId}`);
          
          if (message) {
              input.classList.add('border-red-500');
              input.classList.remove('border-slate-600');
              errorMsg.textContent = message;
          } else {
              input.classList.remove('border-red-500');
              input.classList.add('border-slate-600');
              errorMsg.textContent = '';
          }
      }

      function validateForm() {
          const data = getFormData();
          let isValid = true;

          // Clear previous errors
          ['studentId', 'fullName', 'email', 'phone', 'date', 'startTime', 'hours'].forEach(id => toggleError(id, ''));

          // Student ID validation (YYYY-XXXXX)
          if (!data.studentId) {
              toggleError('studentId', 'Student ID is required');
              isValid = false;
          } else if (!/^\d{4}-\d{5}$/.test(data.studentId)) {
              toggleError('studentId', 'Format: YYYY-XXXXX (e.g., 2021-12345)');
              isValid = false;
          }

          // Email validation
          if (!data.email) {
              toggleError('email', 'Email is required');
              isValid = false;
          } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(data.email)) {
              toggleError('email', 'Please enter a valid email address');
              isValid = false;
          }

          // Phone validation (Philippine format: 09/ +639 followed by 9 digits)
          if (!data.phone) {
              toggleError('phone', 'Phone number is required');
              isValid = false;
          } else if (!/^(09|\+639)\d{9}$/.test(data.phone.replace(/[\s-]/g, ""))) {
              toggleError('phone', 'Valid Philippine phone number (e.g., 09123456789)');
              isValid = false;
          }

          // Other required fields
          if (!data.fullName) { toggleError('fullName', 'Full name is required'); isValid = false; }
          if (!data.date) { toggleError('date', 'Reservation date is required'); isValid = false; }
          if (!data.startTime) { toggleError('startTime', 'Start time is required'); isValid = false; }
          if (data.hours <= 0) { toggleError('hours', 'Please enter a valid number of hours'); isValid = false; }
          
          return isValid;
      }

      function calculateCost() {
          const data = getFormData();
          const hours = data.hours;
          
          let roomFee = hours * 50;
          
          // Apply minimum fee
          if (hours < 2 && hours > 0) {
              roomFee = 75;
              minFeeNote.classList.remove('hidden');
          } else {
              minFeeNote.classList.add('hidden');
          }

          const projectorFee = data.projector ? hours * 150 : 0;
          const speakerMicFee = data.speakerMic ? hours * 150 : 0;

          const total = roomFee + projectorFee + speakerMicFee;
          
          // Update the display
          let html = `
            <div class="flex justify-between text-slate-300">
                <span>Room Fee (${hours} hour${hours !== 1 ? 's' : ''}):</span>
                <span>${formatCurrency(roomFee)}</span>
            </div>
          `;
          
          if (data.projector) {
              html += `
                <div class="flex justify-between text-slate-300">
                    <span>Projector (${hours} hour${hours !== 1 ? 's' : ''}):</span>
                    <span>${formatCurrency(projectorFee)}</span>
                </div>
              `;
          }
          
          if (data.speakerMic) {
              html += `
                <div class="flex justify-between text-slate-300">
                    <span>Speaker & Mic (${hours} hour${hours !== 1 ? 's' : ''}):</span>
                    <span>${formatCurrency(speakerMicFee)}</span>
                </div>
              `;
          }

          html += `
            <div class="border-t border-amber-600/30 pt-3 flex justify-between text-amber-500 font-bold">
                <span>Total Estimated Cost:</span>
                <span>${formatCurrency(total)}</span>
            </div>
          `;

          costDetails.innerHTML = html;
          costBreakdown.classList.remove('hidden');

          return total;
      }

      function updateSubmitButton(cost) {
          if (cost !== null) {
              submitButton.disabled = false;
              submitButton.classList.remove('bg-slate-700', 'text-slate-500', 'cursor-not-allowed');
              submitButton.classList.add('bg-amber-600', 'hover:bg-amber-700', 'text-white');
          } else {
              submitButton.disabled = true;
              submitButton.classList.add('bg-slate-700', 'text-slate-500', 'cursor-not-allowed');
              submitButton.classList.remove('bg-amber-600', 'hover:bg-amber-700', 'text-white');
          }
      }

      function handleCalculate() {
          if (validateForm()) {
              estimatedCost = calculateCost();
              updateSubmitButton(estimatedCost);
              confirmationDiv.classList.add('hidden');
          } else {
              estimatedCost = null;
              updateSubmitButton(estimatedCost);
          }
      }

      function handleSubmit(e) {
          e.preventDefault();
          
          if (!validateForm()) {
              return;
          }

          if (estimatedCost === null) {
              handleCalculate();
              return;
          }
          
          // Show confirmation
          const data = getFormData();
          const formattedDate = new Date(data.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
          const hours = data.hours;

          confirmationDiv.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500 mx-auto mb-4"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            <h3 class="text-slate-100 mb-4">Reservation Request Confirmed!</h3>
            <div class="text-slate-300 space-y-2 max-w-2xl mx-auto">
                <p>
                    Thank you, <strong>${data.fullName}</strong>! Your reservation request
                    has been submitted successfully.
                </p>
                <div class="bg-slate-800/50 rounded-lg p-4 mt-4">
                    <p><strong>Booking Details:</strong></p>
                    <p>Date: ${formattedDate}</p>
                    <p>Time: ${data.startTime}</p>
                    <p>Duration: ${hours} hour${hours !== 1 ? 's' : ''}</p>
                    <p>Estimated Total: ${formatCurrency(estimatedCost)}</p>
                </div>
                <p class="mt-4">
                    We will contact you at <strong>${data.email}</strong> or 
                    <strong>${data.phone}</strong> to confirm your booking and provide
                    payment instructions.
                </p>
                <p class="text-sm text-slate-400 mt-4">
                    Please check your email for confirmation details. See you at Bat Cave Cafe!
                </p>
            </div>
          `;
          confirmationDiv.classList.remove('hidden');
          
          // Scroll to confirmation
          setTimeout(() => {
              confirmationDiv.scrollIntoView({ behavior: "smooth" });
          }, 100);
      }
      
      function handleReset() {
          form.reset();
          estimatedCost = null;
          updateSubmitButton(null);
          costBreakdown.classList.add('hidden');
          confirmationDiv.classList.add('hidden');
          // Reset hidden checkbox inputs
          form.projector.value = 'false';
          form.speakerMic.value = 'false';
          document.getElementById('checkbox-projector').classList.remove('checked');
          document.getElementById('checkbox-speakerMic').classList.remove('checked');
          // Clear all errors
          ['studentId', 'fullName', 'email', 'phone', 'date', 'startTime', 'hours'].forEach(id => toggleError(id, ''));
      }

      // --- Event Listeners ---

      // Listen to input changes to reset cost (matching React behavior)
      const formInputs = document.querySelectorAll('#booking-form input, #booking-form .checkbox-container');
      formInputs.forEach(input => {
          input.addEventListener('change', () => {
              estimatedCost = null;
              updateSubmitButton(null);
          });
      });
      
      // Checkbox click handlers
      function setupCheckbox(containerId, inputId) {
          const container = document.getElementById(containerId);
          const input = document.getElementById(inputId);
          
          container.addEventListener('click', () => {
              const isChecked = input.value === 'true';
              if (isChecked) {
                  container.classList.remove('checked');
                  input.value = 'false';
              } else {
                  container.classList.add('checked');
                  input.value = 'true';
              }
              // Trigger cost reset
              estimatedCost = null;
              updateSubmitButton(null);
          });
      }

      setupCheckbox('checkbox-projector', 'projector');
      setupCheckbox('checkbox-speakerMic', 'speakerMic');

      calculateButton.addEventListener('click', handleCalculate);
      form.addEventListener('submit', handleSubmit);
      resetButton.addEventListener('click', handleReset);
      
    </script>
    
  </body>
</html>